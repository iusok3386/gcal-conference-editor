# gcal-conference-editor

Googleカレンダーのイベントの会議データ URI を編集するための Google Apps Script (GAS) ツールです。これにより、標準の Google カレンダーインターフェースでは編集できないビデオ会議リンク (Zoom, Teams など) を変更するのに役立ちます。

## 主な機能

- カレンダーとイベントを選択するためのシンプルな Web インターフェースを提供します。
- Google Calendar API を使用して、カレンダーとイベントを動的に取得します。
- イベントの会議データを新しい URI で更新します。

## セットアップとデプロイ

このプロジェクトでは、Google Apps Script のコマンドラインツールである `clasp` と、セットアップのために Node.js を使用します。

### 1. 初期セットアップ

[Node.js](https://nodejs.org/) と `npm` がインストールされている必要があります。

1.  **このリポジトリをクローンします:**
    ```bash
    git clone https://github.com/your-username/gcal-conference-editor.git
    cd gcal-conference-editor
    ```

2.  **依存関係をインストールします:**
    これにより、`clasp`やその他必要なパッケージがローカルにインストールされます。
    ```bash
    npm install
    ```

3.  **Googleにログインします:**
    `clasp` が Google アカウントにアクセスすることを承認します。
    ```bash
    npx clasp login
    ```

4.  **Apps Script プロジェクトを作成してリンクします:**
    まず、[script.google.com](https://script.google.com/home/projects/create) で新しい空のスタンドアロンスクリプトプロジェクトを作成します。
    作成後、以下のセットアップスクリプトを実行します。新しい Apps Script プロジェクトのプロジェクト設定 (⚙️ アイコン) にある **スクリプト ID** の入力を求められます。
    ```bash
    npm run setup
    ```

5.  **ファイルをプッシュします:**
    このコマンドは、`src` ディレクトリのファイル (`Code.gs`, `index.html`, `appsscript.json`) を Apps Script プロジェクトにアップロードします。
    ```bash
    npx clasp push
    ```

### 2. Web アプリとしてデプロイする

Web インターフェースを使用するには、スクリプトをデプロイする必要があります。

1.  **Apps Script プロジェクトを開きます:**
    次のコマンドを実行して、Apps Script のオンラインエディタでプロジェクトを開きます。
    ```bash
    npx clasp open-script
    ```

2.  **デプロイを作成します:**
    Apps Script エディタで:
    - **デプロイ** > **新しいデプロイ** をクリックします。
    - 「種類の選択」の横にある歯車アイコン (⚙️) をクリックし、**Web アプリ**を選択します。
    - 設定:
        - **説明:** (任意) 「会議 URI 編集ツール」などの説明を追加します。
        - **次のユーザーとして実行:** **Web アプリにアクセスしているユーザー** を選択します。
        - **アクセスできるユーザー:** アプリを使用できるユーザーを選択します。個人使用の場合は、**自分のみ** が最も安全です。
    - **デプロイ**をクリックします。

3.  **権限を承認します:**
    初めてデプロイする際に、スクリプトの権限を承認するよう求められます。**アクセスを承認**をクリックし、画面の指示に従います。「このアプリは Google で確認されていません」という画面が表示された場合は、「詳細」をクリックし、「[プロジェクト名]に移動 (安全でないページ)」をクリックして続行します。

4.  **Web アプリの URL を取得します:**
    デプロイ後、**Web アプリの URL** が提供されます。これが完成したアプリケーションへのリンクです。

## 使用方法

1.  デプロイ後に取得した **Web アプリの URL** を開きます。
2.  **カレンダーを選択:** アプリケーションは、最初のドロップダウンメニューに Google カレンダーのリストを読み込みます。変更したいイベントが含まれるカレンダーを選択します。
3.  **イベントを選択:** カレンダーを選択すると、2番目のドロップダウンにそのカレンダーの今後のイベントのリストが表示されます。目的のイベントを選択します。
4.  **新しい URI を入力:** 「新しい会議の URI」フィールドに、ビデオ会議の新しいリンクを入力します。
5.  **「会議情報を更新」をクリックします**。
6.  更新が成功したかどうかを示すステータスメッセージが表示されます。